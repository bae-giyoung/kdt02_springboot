<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Login</title>
<link type="text/css" rel="stylesheet" href="./css/login.css">
<script>
async function loginButton() {
	const username = document.getElementById("username").value;
	const password = document.getElementById("password").value;
	
	try{
		const response = await fetch("/login", {
			method: "POST",
			headers: {
				"Content-Type": "application/json"
			},
			body: JSON.stringify({username, password})
		});
		
		if(response.ok) {
			const jwtToken = response.headers.get("Authorization");
			if(jwtToken) {
				sessionStorage.setItem('jwtToken', jwtToken);
				alert("로그인 성공!");
				window.location.href = "./welcome.html";
				return;
			} else {	alert("로그인 실패![토큰 생성 실패]");}
		} else {	alert("로그인 실패!")}
		
	} catch(error) {
		alert("로그인 오류!");
	}
	window.location.href="./login.html";
}
</script>
</head>
<body style="text-align: center;">
	<div class="login-container">
		<h2>로그인</h2>
		<form id="loginForm">
			<div class="form-group">
				<label for="username">Username</label>
				<input type="text" id="username" placeholder="Username" />
			</div>
			<div class="form-group">
				<label for="password">Password</label>
				<input type="password" id="password" placeholder="Password" />
			</div>
			<button type ="button" class="login-btn" onclick="loginButton();">로그인</button>
		</form>
		<div class="divider">
			<span>또는</span>
		</div>
		<a href="/oauth2/authorization/google" class="oauth2-login-btn google-login">구글 로그인</a>
		<a href="/oauth2/authorization/naver" class="oauth2-login-btn naver-login">네이버 로그인</a>
	</div>
</body>
</html>